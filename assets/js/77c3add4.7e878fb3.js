"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9245],{3905:(e,t,r)=>{r.d(t,{Zo:()=>d,kt:()=>g});var o=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,o,a=function(e,t){if(null==e)return{};var r,o,a={},n=Object.keys(e);for(o=0;o<n.length;o++)r=n[o],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)r=n[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var p=o.createContext({}),l=function(e){var t=o.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},d=function(e){var t=l(e.components);return o.createElement(p.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},c=o.forwardRef((function(e,t){var r=e.components,a=e.mdxType,n=e.originalType,p=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),u=l(r),c=a,g=u["".concat(p,".").concat(c)]||u[c]||m[c]||n;return r?o.createElement(g,s(s({ref:t},d),{},{components:r})):o.createElement(g,s({ref:t},d))}));function g(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var n=r.length,s=new Array(n);s[0]=c;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i[u]="string"==typeof e?e:a,s[1]=i;for(var l=2;l<n;l++)s[l]=r[l];return o.createElement.apply(null,s)}return o.createElement.apply(null,r)}c.displayName="MDXCreateElement"},6687:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>m,frontMatter:()=>n,metadata:()=>i,toc:()=>l});var o=r(7462),a=(r(7294),r(3905));const n={sidebar_position:1},s="Storage",i={unversionedId:"repositories/storage",id:"repositories/storage",title:"Storage",description:'In automerge-repo "storage" refers to any implementation of StorageAdapter. You can_ run a Repo without a StorageAdapter but it will be entirely transient and will have to load all it\'s data from remote peers on every restart.',source:"@site/docs/repositories/storage.md",sourceDirName:"repositories",slug:"/repositories/storage",permalink:"/docs/repositories/storage",draft:!1,editUrl:"https://github.com/automerge/automerge.github.io/edit/main/docs/repositories/storage.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Repositories",permalink:"/docs/repositories/"},next:{title:"Networking",permalink:"/docs/repositories/networking"}},p={},l=[{value:"IndexedDB",id:"indexeddb",level:2},{value:"File system",id:"file-system",level:2},{value:"Roll your own",id:"roll-your-own",level:2}],d={toc:l},u="wrapper";function m(e){let{components:t,...r}=e;return(0,a.kt)(u,(0,o.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"storage"},"Storage"),(0,a.kt)("p",null,"In ",(0,a.kt)("inlineCode",{parentName:"p"},"automerge-repo"),' "storage" refers to any implementation of ',(0,a.kt)("a",{parentName:"p",href:"https://automerge.org/automerge-repo/classes/_automerge_automerge_repo.StorageAdapter.html"},(0,a.kt)("inlineCode",{parentName:"a"},"StorageAdapter")),". You ",(0,a.kt)("em",{parentName:"p"},"can")," run a ",(0,a.kt)("inlineCode",{parentName:"p"},"Repo")," without a ",(0,a.kt)("inlineCode",{parentName:"p"},"StorageAdapter")," but it will be entirely transient and will have to load all it's data from remote peers on every restart."),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"StorageAdapter")," is designed to be safe to use concurrently, that is to say it is safe to have multiple ",(0,a.kt)("inlineCode",{parentName:"p"},"Repo"),"s talking to the same storage."),(0,a.kt)("p",null,"There are two built in storage adapters:"),(0,a.kt)("h2",{id:"indexeddb"},"IndexedDB"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@automerge/automerge-repo-storage-indexeddb"},(0,a.kt)("inlineCode",{parentName:"a"},"@automerge/automerge-repo-storage-indexeddb"))," stores data in an ",(0,a.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API"},(0,a.kt)("inlineCode",{parentName:"a"},"IndexedDB"))," in the browser."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},'import { IndexedDBStorageAdapter } from "@automerge/automerge-repo-storage-indexeddb`\n\nconst storage = new IndexedDBStorageAdapter()\n')),(0,a.kt)("p",null,"You can customize the object database and object store the storage uses, see ",(0,a.kt)("a",{parentName:"p",href:"https://automerge.org/automerge-repo/classes/_automerge_automerge_repo_storage_indexeddb.IndexedDBStorageAdapter.html#constructor"},"the docs")),(0,a.kt)("p",null,"As noted above, this is safe for concurrent use so you can have multiple tabs pointing at the same storage. Note that they will not live update (you may want to use a ",(0,a.kt)("a",{parentName:"p",href:"https://automerge.org/automerge-repo/modules/_automerge_automerge_repo_network_messagechannel.html"},(0,a.kt)("inlineCode",{parentName:"a"},"MessageChannel"))," or ",(0,a.kt)("a",{parentName:"p",href:"https://automerge.org/automerge-repo/modules/_automerge_automerge_repo_network_broadcastchannel.html"},(0,a.kt)("inlineCode",{parentName:"a"},"BroadcastChannel"))," based ",(0,a.kt)("inlineCode",{parentName:"p"},"NetworkAdapter")," for that) but on refresh the concurrent changes will be merged as per the normal merge rules."),(0,a.kt)("h2",{id:"file-system"},"File system"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@automerge/automerge-repo-storage-nodefs"},(0,a.kt)("inlineCode",{parentName:"a"},"@automerge/automerge-repo-storage-nodefs"))," is a ",(0,a.kt)("inlineCode",{parentName:"p"},"StorageAdapter")," which stores its data in a directory on the local filesystem. The location can be customized as per ",(0,a.kt)("a",{parentName:"p",href:"https://automerge.org/automerge-repo/classes/_automerge_automerge_repo_storage_nodefs.NodeFSStorageAdapter.html#constructor"},"the docs")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},'import { NodeFSStorageAdapter } from "@automerge/automerge-repo-storage-nodefs"\nconst storage = new NodeFSStorageAdapter()\n')),(0,a.kt)("p",null,"As with the ",(0,a.kt)("inlineCode",{parentName:"p"},"IndexedDB")," adapter this adapter is safe for multiple processes to use the same data directory."),(0,a.kt)("h2",{id:"roll-your-own"},"Roll your own"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"StorageAdapter")," is designed to be easy to implement. It should be straightforward to build on top of any key/value store which supports range queries."))}m.isMDXComponent=!0}}]);